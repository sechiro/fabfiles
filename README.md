fabfiles
========

使えそうなFabricタスクをアップしていく予定です。


## dtop

複数サーバのdstatの結果をtop風にコンソールにまとめて表示するタスクです。
Fabricの並列実行の仕組みで、各サーバで dstat を実行して表示します。

### 使用方法

$ fab -H 192.168.1.1,localhost dtop

まず、/tmp/dstat を実行しようとして、失敗するとPATHが通ったdstatを実行します。

$ fab -H 192.168.1.1,localhost dtop.put_dstat:dstat_file=/path/to/dstat,dst=/tmp

これは、dstat 実行ファイル配布用の補助タスクです。各サーバに dstat を配布して実行権限をつけます。

* 制限事項
    * Fabricの並列実行時の制限で、インタラクティブなパスワード入力ができません。パスワードなしでのログインができるように設定するなどで対応してください。
    * 表示画面の初期化が対象サーバ数だけ走ってしまうため、起動直後は何回も画面再描画が走ります。これは、Fabricの並列実行時の制限で @runs_once デコレータが指定されていても、並列実行時にはそれぞれのホストに対して1回実行されてしまうという仕様によります。
